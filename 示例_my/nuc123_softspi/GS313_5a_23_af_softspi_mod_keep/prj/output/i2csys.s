; generated by ARM C/C++ Compiler, 5.03 [Build 76]
; commandline ArmCC [--debug -c --asm --info=totals -o.\output\i2csys.o --depend=.\output\i2csys.d --cpu=Cortex-M0 --apcs=interwork -O0 -I..\CMSIS\CM0\DeviceSupport\Nuvoton\NUC123Series -I..\CMSIS\CM0\CoreSupport -I..\INC\DrvInc -I..\INC\SysInc -I..\dw -IC:\Keil_v472\ARM\RV31\INC -IC:\Keil_v472\ARM\CMSIS\Include -IC:\Keil_v472\ARM\Inc\Nuvoton\NUC123Series -D__MICROLIB --omf_browse=.\output\i2csys.crf ..\AppSrc\i2cSys.c]
        THUMB
        REQUIRE8
        PRESERVE8

        AREA ||.text||, CODE, READONLY, ALIGN=2

GPIO_SET_MODE PROC
        PUSH     {r4,r5,lr}
        LDR      r3,[r0,#0]
        LSLS     r5,r1,#1
        MOVS     r4,#3
        LSLS     r4,r4,r5
        BICS     r3,r3,r4
        LSLS     r5,r1,#1
        MOV      r4,r2
        LSLS     r4,r4,r5
        ORRS     r3,r3,r4
        STR      r3,[r0,#0]
        POP      {r4,r5,pc}
        ENDP

resumeI2c PROC
        MOVS     r0,#0xa0
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        MOVS     r0,#0
        LDR      r1,|L1.1048|
        STR      r0,[r1,#0]  ; i2c_block_chain_header
        LDR      r1,|L1.1052|
        STR      r0,[r1,#0]  ; i2c_block_chain_tail
        LDR      r1,|L1.1056|
        STR      r0,[r1,#0]  ; i2c_current_block
        BX       lr
        ENDP

initI2cDataBlock PROC
        PUSH     {r4-r6,lr}
        LDR      r5,[sp,#0x14]
        LDR      r4,[sp,#0x10]
        STRB     r1,[r0,#0]
        STRB     r2,[r0,#1]
        STRB     r3,[r0,#2]
        STRB     r4,[r0,#3]
        STRB     r4,[r0,#4]
        STR      r5,[r0,#8]
        MOVS     r6,#0
        STR      r6,[r0,#0xc]
        POP      {r4-r6,pc}
        ENDP

readI2cChain PROC
        LDR      r0,|L1.1048|
        LDR      r0,[r0,#0]  ; i2c_block_chain_header
        CMP      r0,#0
        BNE      |L1.88|
        LDR      r1,|L1.1056|
        STR      r0,[r1,#0]  ; i2c_current_block
        LDR      r1,|L1.1052|
        STR      r0,[r1,#0]  ; i2c_block_chain_tail
|L1.86|
        BX       lr
|L1.88|
        LDR      r0,|L1.1048|
        LDR      r0,[r0,#0]  ; i2c_block_chain_header
        LDR      r1,|L1.1056|
        STR      r0,[r1,#0]  ; i2c_current_block
        LDR      r0,|L1.1048|
        LDR      r0,[r0,#0]  ; i2c_block_chain_header
        LDR      r0,[r0,#0xc]
        LDR      r1,|L1.1048|
        STR      r0,[r1,#0]  ; i2c_block_chain_header
        MOV      r0,r1
        LDR      r0,[r0,#0]  ; i2c_block_chain_header
        CMP      r0,#0
        BNE      |L1.120|
        STR      r0,[r1,#0]  ; i2c_block_chain_header
        LDR      r1,|L1.1052|
        STR      r0,[r1,#0]  ; i2c_block_chain_tail
|L1.120|
        NOP      
        B        |L1.86|
        ENDP

i2cSpirit PROC
        PUSH     {r4,lr}
        LDR      r0,|L1.1044|
        LDRB     r0,[r0,#0]  ; i2c_state
        CMP      r0,#0xa0
        BEQ      |L1.148|
        CMP      r0,#0xa1
        BEQ      |L1.282|
        CMP      r0,#0xa2
        BEQ      |L1.396|
        CMP      r0,#0xa3
        BNE      |L1.398|
        B        |L1.186|
|L1.148|
        BL       readI2cChain
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        CMP      r0,#0
        BEQ      |L1.184|
        MOVS     r0,#0xa2
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        LDR      r0,|L1.1060|
        BL       I2C_START
        LDR      r0,|L1.1060|
        BL       I2C_ENABLE_TOC
        MOVS     r0,#0
        LDR      r1,|L1.1064|
        STR      r0,[r1,#0]  ; repeat_time
|L1.184|
        B        |L1.432|
|L1.186|
        LDR      r0,|L1.1064|
        LDR      r0,[r0,#0]  ; repeat_time
        ADDS     r0,r0,#1
        LDR      r1,|L1.1064|
        STR      r0,[r1,#0]  ; repeat_time
        CMP      r0,#1
        BLS      |L1.248|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        CMP      r0,#0
        BEQ      |L1.218|
        MOVS     r0,#0xa3
        LDR      r1,|L1.1056|
        LDR      r1,[r1,#0]  ; i2c_current_block
        LDR      r1,[r1,#8]
        STRB     r0,[r1,#0]
|L1.218|
        BL       readI2cChain
        MOVS     r0,#0xa0
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        CMP      r0,#0
        BEQ      |L1.280|
        MOVS     r0,#0xa2
        STRB     r0,[r1,#0]
        LDR      r0,|L1.1060|
        BL       I2C_START
        B        |L1.280|
|L1.248|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        CMP      r0,#0
        BEQ      |L1.280|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#4]
        LDR      r1,|L1.1056|
        LDR      r1,[r1,#0]  ; i2c_current_block
        STRB     r0,[r1,#3]
        MOVS     r0,#0xa2
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        LDR      r0,|L1.1060|
        BL       I2C_START
|L1.280|
        B        |L1.432|
|L1.282|
        LDR      r0,|L1.1060|
        BL       I2C_DISABLE_I2C
        MOVS     r0,#0xff
        ADDS     r0,#1
        LDR      r1,|L1.1068|
        LDR      r1,[r1,#8]
        BICS     r1,r1,r0
        LDR      r2,|L1.1068|
        STR      r1,[r2,#8]
        NOP      
        NOP      
        MOVS     r1,#5
        LSLS     r1,r1,#28
        LDR      r1,[r1,#0xc]
        ORRS     r1,r1,r0
        MOVS     r2,#5
        LSLS     r2,r2,#28
        STR      r1,[r2,#0xc]
        MOV      r1,r2
        LDR      r1,[r1,#0xc]
        BICS     r1,r1,r0
        STR      r1,[r2,#0xc]
        NOP      
        NOP      
        LDR      r1,|L1.1068|
        LDR      r1,[r1,#8]
        ORRS     r1,r1,r0
        LDR      r2,|L1.1068|
        STR      r1,[r2,#8]
        NOP      
        LDR      r0,|L1.1072|
        LDR      r1,|L1.1060|
        LDR      r1,[r1,#0x10]
        ORRS     r1,r1,r0
        LDR      r2,|L1.1060|
        STR      r1,[r2,#0x10]
        NOP      
        NOP      
        MOV      r0,r2
        LDR      r0,[r0,#0]
        MOVS     r1,#0x40
        ORRS     r0,r0,r1
        MOV      r1,r2
        STR      r0,[r1,#0]
        NOP      
        NOP      
        MOV      r0,r1
        LDR      r0,[r0,#0]
        MOVS     r1,#0x80
        ORRS     r0,r0,r1
        MOV      r1,r2
        STR      r0,[r1,#0]
        NOP      
        MOVS     r0,#0xa3
        LDR      r1,|L1.1044|
        B        |L1.400|
|L1.396|
        B        |L1.404|
|L1.398|
        B        |L1.430|
|L1.400|
        STRB     r0,[r1,#0]
        B        |L1.432|
|L1.404|
        LDR      r0,|L1.1076|
        LDR      r0,[r0,#0]  ; busy_time
        ADDS     r0,r0,#1
        LDR      r1,|L1.1076|
        STR      r0,[r1,#0]  ; busy_time
        CMP      r0,#0x14
        BLS      |L1.426|
        MOVS     r0,#0xa1
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        B        |L1.428|
|L1.426|
        POP      {r4,pc}
|L1.428|
        B        |L1.432|
|L1.430|
        NOP      
|L1.432|
        NOP      
        MOVS     r0,#0
        LDR      r1,|L1.1076|
        STR      r0,[r1,#0]  ; busy_time
        NOP      
        B        |L1.426|
        ENDP

addI2cChain PROC
        PUSH     {r4-r6,lr}
        MOV      r4,r0
        MOV      r5,r1
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        CMP      r4,r0
        BNE      |L1.474|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDR      r0,[r0,#8]
        LDRB     r0,[r0,#0]
        CMP      r0,#0xa0
        BEQ      |L1.474|
        MOVS     r0,#0
|L1.472|
        POP      {r4-r6,pc}
|L1.474|
        LDRB     r0,[r4,#4]
        STRB     r0,[r4,#3]
        LDR      r0,|L1.1052|
        LDR      r0,[r0,#0]  ; i2c_block_chain_tail
        CMP      r0,#0
        BEQ      |L1.552|
        CMP      r5,#0
        BEQ      |L1.518|
        LDR      r0,|L1.1048|
        LDR      r0,[r0,#0]  ; i2c_block_chain_header
        CMP      r4,r0
        BNE      |L1.502|
        MOVS     r0,#0
        B        |L1.472|
|L1.502|
        LDR      r0,|L1.1048|
        LDR      r0,[r0,#0]  ; i2c_block_chain_header
        STR      r0,[r4,#0xc]
        LDR      r0,|L1.1048|
        STR      r4,[r0,#0]  ; i2c_block_chain_header
        BL       i2cSpirit
        B        |L1.566|
|L1.518|
        LDR      r0,|L1.1052|
        LDR      r0,[r0,#0]  ; i2c_block_chain_tail
        CMP      r4,r0
        BNE      |L1.536|
        LDR      r0,|L1.1048|
        LDR      r0,[r0,#0]  ; i2c_block_chain_header
        CMP      r0,#0
        BNE      |L1.536|
        B        |L1.554|
|L1.536|
        LDR      r0,|L1.1052|
        LDR      r0,[r0,#0]  ; i2c_block_chain_tail
        STR      r4,[r0,#0xc]
        LDR      r0,|L1.1052|
        STR      r4,[r0,#0]  ; i2c_block_chain_tail
        MOVS     r0,#0
        STR      r0,[r4,#0xc]
        B        |L1.566|
|L1.552|
        NOP      
|L1.554|
        LDR      r0,|L1.1048|
        STR      r4,[r0,#0]  ; i2c_block_chain_header
        LDR      r0,|L1.1052|
        STR      r4,[r0,#0]  ; i2c_block_chain_tail
        MOVS     r0,#0
        STR      r0,[r4,#0xc]
|L1.566|
        MOVS     r0,#1
        B        |L1.472|
        ENDP

I2C0_IRQHandler PROC
        PUSH     {r4,lr}
        NOP      
        LDR      r0,|L1.1060|
        LDR      r0,[r0,#0x14]
        LSLS     r0,r0,#31
        LSRS     r0,r0,#31
        CMP      r0,#0
        BEQ      |L1.622|
        LDR      r0,|L1.1060|
        BL       I2C_DISABLE_TOC
        NOP      
        LDR      r0,|L1.1060|
        LDR      r0,[r0,#0x14]
        MOVS     r1,#1
        ORRS     r0,r0,r1
        LDR      r1,|L1.1060|
        STR      r0,[r1,#0x14]
        NOP      
        MOV      r0,r1
        BL       I2C_STOP
        MOVS     r0,#0xa3
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
|L1.620|
        POP      {r4,pc}
|L1.622|
        NOP      
        LDR      r0,|L1.1060|
        LDR      r4,[r0,#0xc]
        NOP      
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#0]
        LSLS     r0,r0,#31
        LSRS     r0,r0,#31
        BEQ      |L1.644|
        B        |L1.890|
|L1.644|
        CMP      r4,#8
        BEQ      |L1.662|
        CMP      r4,#0x18
        BEQ      |L1.682|
        CMP      r4,#0x28
        BEQ      |L1.724|
        CMP      r4,#0x38
        BNE      |L1.870|
        B        |L1.850|
|L1.662|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r1,[r0,#0]
        LDR      r0,|L1.1060|
        BL       I2C_SET_DATA
        LDR      r0,|L1.1060|
        BL       I2C_CLEAR_SI
        B        |L1.620|
|L1.682|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r2,[r0,#3]
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#3]
        ADDS     r0,r0,#1
        LDR      r3,|L1.1056|
        LDR      r3,[r3,#0]  ; i2c_current_block
        STRB     r0,[r3,#3]
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDR      r0,[r0,#8]
        LDRB     r1,[r0,r2]
        LDR      r0,|L1.1060|
        BL       I2C_SET_DATA
        LDR      r0,|L1.1060|
        BL       I2C_CLEAR_SI
        B        |L1.620|
|L1.724|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#1]
        CMP      r0,#1
        BNE      |L1.758|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#0]
        MOVS     r1,#1
        ORRS     r0,r0,r1
        LDR      r1,|L1.1056|
        LDR      r1,[r1,#0]  ; i2c_current_block
        STRB     r0,[r1,#0]
        LDR      r0,|L1.1060|
        BL       I2C_START
        B        |L1.620|
|L1.758|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#2]
        LDR      r1,|L1.1056|
        LDR      r1,[r1,#0]  ; i2c_current_block
        LDRB     r1,[r1,#3]
        CMP      r0,r1
        BGE      |L1.808|
        LDR      r0,|L1.1060|
        BL       I2C_STOP
        LDR      r0,|L1.1060|
        BL       I2C_DISABLE_TOC
        MOVS     r0,#0xa0
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        LDR      r1,|L1.1056|
        LDR      r1,[r1,#0]  ; i2c_current_block
        LDR      r1,[r1,#8]
        STRB     r0,[r1,#0]
        MOVS     r0,#0
        LDR      r1,|L1.1056|
        STR      r0,[r1,#0]  ; i2c_current_block
        B        |L1.620|
|L1.808|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r2,[r0,#3]
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#3]
        ADDS     r0,r0,#1
        LDR      r3,|L1.1056|
        LDR      r3,[r3,#0]  ; i2c_current_block
        STRB     r0,[r3,#3]
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDR      r0,[r0,#8]
        LDRB     r1,[r0,r2]
        LDR      r0,|L1.1060|
        BL       I2C_SET_DATA
        LDR      r0,|L1.1060|
        BL       I2C_CLEAR_SI
        B        |L1.620|
|L1.850|
        LDR      r0,|L1.1060|
        BL       I2C_STOP
        LDR      r0,|L1.1060|
        BL       I2C_DISABLE_TOC
        MOVS     r0,#0xa1
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        B        |L1.620|
|L1.870|
        LDR      r0,|L1.1060|
        BL       I2C_STOP
        LDR      r0,|L1.1060|
        BL       I2C_DISABLE_TOC
        MOVS     r0,#0xa3
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        B        |L1.620|
|L1.890|
        CMP      r4,#0x48
        BEQ      |L1.948|
        BGT      |L1.910|
        CMP      r4,#8
        BEQ      |L1.922|
        CMP      r4,#0x10
        BEQ      |L1.920|
        CMP      r4,#0x40
|L1.906|
        BNE      |L1.1132|
        B        |L1.962|
|L1.910|
        CMP      r4,#0x50
        BEQ      |L1.1136|
        CMP      r4,#0x58
        BNE      |L1.906|
        B        |L1.1000|
|L1.920|
        NOP      
|L1.922|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#0]
        MOVS     r2,#1
        ORRS     r0,r0,r2
        MOV      r1,r0
        LDR      r0,|L1.1060|
        BL       I2C_SET_DATA
        LDR      r0,|L1.1060|
        BL       I2C_CLEAR_SI
        B        |L1.620|
|L1.948|
        LDR      r0,|L1.1060|
        BL       I2C_STOP
        MOVS     r0,#0xa3
        LDR      r1,|L1.1044|
        STRB     r0,[r1,#0]
        B        |L1.620|
|L1.962|
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#2]
        LDR      r1,|L1.1056|
        LDR      r1,[r1,#0]  ; i2c_current_block
        LDRB     r1,[r1,#3]
        CMP      r0,r1
        BLE      |L1.986|
        LDR      r0,|L1.1060|
        BL       I2C_SET_AA
        B        |L1.992|
|L1.986|
        LDR      r0,|L1.1060|
        BL       I2C_CLEAR_AA
|L1.992|
        LDR      r0,|L1.1060|
        BL       I2C_CLEAR_SI
        B        |L1.620|
|L1.1000|
        NOP      
        LDR      r0,|L1.1060|
        LDR      r0,[r0,#8]
        UXTB     r1,r0
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r2,[r0,#3]
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#3]
        ADDS     r0,r0,#1
        LDR      r3,|L1.1056|
        LDR      r3,[r3,#0]  ; i2c_current_block
        STRB     r0,[r3,#3]
        LDR      r0,|L1.1056|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDR      r0,[r0,#8]
        STRB     r1,[r0,r2]
        LDR      r0,|L1.1060|
        BL       I2C_STOP
        B        |L1.1080|
|L1.1044|
        DCD      i2c_state
|L1.1048|
        DCD      i2c_block_chain_header
|L1.1052|
        DCD      i2c_block_chain_tail
|L1.1056|
        DCD      i2c_current_block
|L1.1060|
        DCD      0x40020000
|L1.1064|
        DCD      repeat_time
|L1.1068|
        DCD      0x50000200
|L1.1072|
        DCD      0x0000c350
|L1.1076|
        DCD      busy_time
|L1.1080|
        LDR      r0,|L1.2088|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#2]
        LDR      r1,|L1.2088|
        LDR      r1,[r1,#0]  ; i2c_current_block
        LDRB     r1,[r1,#3]
        CMP      r0,r1
        BGE      |L1.1118|
        MOVS     r0,#0xa0
        LDR      r1,|L1.2092|
        STRB     r0,[r1,#0]
        LDR      r1,|L1.2088|
        LDR      r1,[r1,#0]  ; i2c_current_block
        LDR      r1,[r1,#8]
        STRB     r0,[r1,#0]
        MOVS     r0,#0
        LDR      r1,|L1.2088|
        STR      r0,[r1,#0]  ; i2c_current_block
        B        |L1.1130|
|L1.1118|
        MOVS     r0,#0xa3
        LDR      r1,|L1.2092|
        STRB     r0,[r1,#0]
        MOVS     r0,#0
        LDR      r1,|L1.2088|
        STR      r0,[r1,#0]  ; i2c_current_block
|L1.1130|
        B        |L1.620|
|L1.1132|
        B        |L1.1210|
        B        |L1.1136|
|L1.1136|
        NOP      
        LDR      r0,|L1.2096|
        LDR      r0,[r0,#8]
        UXTB     r1,r0
        LDR      r0,|L1.2088|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r2,[r0,#3]
        LDR      r0,|L1.2088|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#3]
        ADDS     r0,r0,#1
        LDR      r3,|L1.2088|
        LDR      r3,[r3,#0]  ; i2c_current_block
        STRB     r0,[r3,#3]
        LDR      r0,|L1.2088|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDR      r0,[r0,#8]
        STRB     r1,[r0,r2]
        LDR      r0,|L1.2088|
        LDR      r0,[r0,#0]  ; i2c_current_block
        LDRB     r0,[r0,#2]
        LDR      r1,|L1.2088|
        LDR      r1,[r1,#0]  ; i2c_current_block
        LDRB     r1,[r1,#3]
        CMP      r0,r1
        BLE      |L1.1196|
        LDR      r0,|L1.2096|
        BL       I2C_SET_AA
        B        |L1.1202|
|L1.1196|
        LDR      r0,|L1.2096|
        BL       I2C_CLEAR_AA
|L1.1202|
        LDR      r0,|L1.2096|
        BL       I2C_CLEAR_SI
        B        |L1.620|
|L1.1210|
        LDR      r0,|L1.2096|
        BL       I2C_STOP
        MOVS     r0,#0xa3
        LDR      r1,|L1.2092|
        STRB     r0,[r1,#0]
        NOP      
        B        |L1.620|
        ENDP

i2cSysInit PROC
        PUSH     {r4,lr}
        MOVS     r2,#2
        MOVS     r1,#3
        LDR      r0,|L1.2100|
        BL       GPIO_SET_MODE
        MOVS     r2,#2
        MOV      r1,r2
        LDR      r0,|L1.2100|
        BL       GPIO_SET_MODE
        NOP      
        LDR      r0,|L1.2104|
        LDR      r0,[r0,#4]
        MOVS     r1,#0xc
        ORRS     r0,r0,r1
        LDR      r1,|L1.2104|
        STR      r0,[r1,#4]
        MOV      r0,r1
        LDR      r0,[r0,#0x14]
        MOVS     r1,#0xf
        LSLS     r1,r1,#24
        BICS     r0,r0,r1
        MOVS     r1,#5
        LSLS     r1,r1,#25
        ADDS     r0,r0,r1
        LDR      r1,|L1.2104|
        STR      r0,[r1,#0x14]
        NOP      
        MOVS     r1,#2
        MOVS     r0,#0x12
        BL       NVIC_SetPriority
        MOVS     r2,#1
        LDR      r1,|L1.2108|
        LDR      r0,|L1.2096|
        BL       DrvI2C_Init
        NOP      
        LDR      r0,|L1.2096|
        LDR      r0,[r0,#0x14]
        MOVS     r1,#2
        ORRS     r0,r0,r1
        LDR      r1,|L1.2096|
        STR      r0,[r1,#0x14]
        NOP      
        MOV      r0,r1
        BL       I2C_ENABLE_TOC
        POP      {r4,pc}
        ENDP

delayus PROC
        PUSH     {r4,lr}
        MOV      r4,r0
        MOV      r0,r4
        BL       sysDelayUs
        POP      {r4,pc}
        ENDP

i2cAck PROC
        PUSH     {r3,lr}
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_SET_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_SET_PIN
        MOVS     r0,#3
        BL       delayus
        NOP      
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        LDR      r0,[r0,#0]
        STR      r0,[sp,#0]
        MOVS     r0,#3
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,[sp,#0]
        POP      {r3,pc}
        ENDP

ack PROC
        PUSH     {r4,lr}
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#3
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_CLR_PIN
        MOVS     r0,#3
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_SET_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_SET_PIN
        MOVS     r0,#3
        BL       delayus
        POP      {r4,pc}
        ENDP

nack PROC
        PUSH     {r4,lr}
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#3
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_SET_PIN
        MOVS     r0,#3
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_SET_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_SET_PIN
        MOVS     r0,#3
        BL       delayus
        POP      {r4,pc}
        ENDP

i2cRestart PROC
        PUSH     {r4,lr}
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_SET_PIN
        MOVS     r0,#0x3c
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_SET_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        POP      {r4,pc}
        ENDP

i2cStop PROC
        PUSH     {r4,lr}
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_SET_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_SET_PIN
        MOVS     r0,#6
        BL       delayus
        POP      {r4,pc}
        ENDP

i2cWriteByte PROC
        PUSH     {r4-r6,lr}
        MOV      r6,r0
        MOVS     r4,#0x80
        MOVS     r5,#0
        B        |L1.1726|
|L1.1668|
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#3
        BL       delayus
        MOV      r0,r6
        TST      r0,r4
        BEQ      |L1.1696|
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_SET_PIN
        B        |L1.1704|
|L1.1696|
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_CLR_PIN
|L1.1704|
        MOVS     r0,#3
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_SET_PIN
        MOVS     r0,#6
        BL       delayus
        ASRS     r4,r4,#1
        ADDS     r5,r5,#1
|L1.1726|
        CMP      r5,#8
        BCC      |L1.1668|
        POP      {r4-r6,pc}
        ENDP

i2cReadByte PROC
        PUSH     {r4-r6,lr}
        MOVS     r6,#0
        MOVS     r4,#0x80
        MOVS     r5,#0
        B        |L1.1788|
|L1.1742|
        LDR      r0,|L1.2112|
        BL       GPIO_CLR_PIN
        MOVS     r0,#6
        BL       delayus
        LDR      r0,|L1.2112|
        BL       GPIO_SET_PIN
        MOVS     r0,#6
        BL       delayus
        NOP      
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        LDR      r0,[r0,#0]
        CMP      r0,#0
        BEQ      |L1.1784|
        MOV      r0,r6
        ORRS     r0,r0,r4
        MOV      r6,r0
|L1.1784|
        ASRS     r4,r4,#1
        ADDS     r5,r5,#1
|L1.1788|
        CMP      r5,#8
        BCC      |L1.1742|
        MOV      r0,r6
        POP      {r4-r6,pc}
        ENDP

i2cStart PROC
        PUSH     {r4,lr}
        MOV      r4,r0
        LDR      r0,|L1.2096|
        BL       I2C_DISABLE_I2C
        LDR      r0,|L1.2096|
        BL       I2C_DISABLE_TOC
        LDR      r0,|L1.2104|
        LDR      r0,[r0,#4]
        MOVS     r1,#0xc
        BICS     r0,r0,r1
        LDR      r1,|L1.2104|
        STR      r0,[r1,#4]
        MOV      r0,r1
        LDR      r0,[r0,#0x14]
        MOVS     r1,#0xf
        LSLS     r1,r1,#24
        BICS     r0,r0,r1
        LDR      r1,|L1.2104|
        STR      r0,[r1,#0x14]
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_SET_PIN
        LDR      r0,|L1.2112|
        BL       GPIO_SET_PIN
        MOVS     r2,#2
        MOV      r1,r2
        LDR      r0,|L1.2100|
        BL       GPIO_SET_MODE
        MOVS     r2,#2
        MOVS     r1,#3
        LDR      r0,|L1.2100|
        BL       GPIO_SET_MODE
        MOVS     r0,#0xa
        BL       delayus
        LDR      r0,|L1.2112|
        SUBS     r0,r0,#4
        BL       GPIO_CLR_PIN
        MOVS     r0,#0x14
        BL       delayus
        MOV      r0,r4
        BL       i2cWriteByte
        BL       i2cAck
        CMP      r0,#0
        BEQ      |L1.1910|
        MOVS     r0,#1
|L1.1908|
        POP      {r4,pc}
|L1.1910|
        MOVS     r0,#0
        B        |L1.1908|
        ENDP

readBuf PROC
        PUSH     {r3-r7,lr}
        MOV      r5,r0
        MOV      r6,r1
        MOV      r7,r2
        MOVS     r0,#0
        LDR      r1,|L1.2116|
        STR      r0,[r1,#0]  ; ack_error
        LDR      r0,|L1.2120|
        LDRB     r0,[r0,#0]  ; DEVICE_ADDRESS
        BL       i2cStart
        CMP      r0,#0
        BNE      |L1.2136|
        MOVS     r0,#0xa
        BL       delayus
        MOVS     r1,#0xff
        LSLS     r1,r1,#8
        ANDS     r1,r1,r6
        LSRS     r0,r1,#8
        BL       i2cWriteByte
        BL       i2cAck
        CMP      r0,#1
        BNE      |L1.1976|
        LDR      r1,|L1.2116|
        STR      r0,[r1,#0]  ; ack_error
        BL       i2cStop
|L1.1974|
        POP      {r3-r7,pc}
|L1.1976|
        MOVS     r0,#0xa
        BL       delayus
        UXTB     r0,r6
        BL       i2cWriteByte
        BL       i2cAck
        CMP      r0,#1
        BNE      |L1.2006|
        LDR      r1,|L1.2116|
        STR      r0,[r1,#0]  ; ack_error
        BL       i2cStop
        B        |L1.1974|
|L1.2006|
        MOVS     r0,#0xa
        BL       delayus
        BL       i2cRestart
        LDR      r1,|L1.2120|
        LDRB     r1,[r1,#0]  ; DEVICE_ADDRESS
        MOVS     r2,#1
        ORRS     r1,r1,r2
        MOV      r0,r1
        BL       i2cWriteByte
        BL       i2cAck
        CMP      r0,#0
        BNE      |L1.2124|
        MOVS     r4,#0
        B        |L1.2060|
|L1.2042|
        MOVS     r0,#0xfa
        BL       delayus
        BL       i2cReadByte
        STRB     r0,[r5,r4]
        BL       ack
        ADDS     r4,r4,#1
|L1.2060|
        SUBS     r0,r7,#1
        CMP      r0,r4
        BHI      |L1.2042|
        MOVS     r0,#0xfa
        BL       delayus
        BL       i2cReadByte
        STRB     r0,[r5,r4]
        BL       nack
        BL       i2cStop
        B        |L1.1974|
|L1.2088|
        DCD      i2c_current_block
|L1.2092|
        DCD      i2c_state
|L1.2096|
        DCD      0x40020000
|L1.2100|
        DCD      0x50004140
|L1.2104|
        DCD      0x50000040
|L1.2108|
        DCD      0x0000c350
|L1.2112|
        DCD      0x5000434c
|L1.2116|
        DCD      ack_error
|L1.2120|
        DCD      DEVICE_ADDRESS
|L1.2124|
        MOVS     r0,#1
        LDR      r1,|L1.2364|
        STR      r0,[r1,#0]  ; ack_error
        BL       i2cStop
        B        |L1.2146|
|L1.2136|
        MOVS     r0,#1
        LDR      r1,|L1.2364|
        STR      r0,[r1,#0]  ; ack_error
        BL       i2cStop
|L1.2146|
        NOP      
        B        |L1.1974|
        ENDP

NVIC_SetPriority PROC
        PUSH     {r4,lr}
        CMP      r0,#0
        BGE      |L1.2208|
        LDR      r2,|L1.2368|
        LSLS     r3,r0,#28
        LSRS     r3,r3,#28
        SUBS     r3,r3,#8
        LSRS     r3,r3,#2
        LSLS     r3,r3,#2
        LDR      r2,[r2,r3]
        LSLS     r3,r0,#30
        LSRS     r4,r3,#27
        MOVS     r3,#0xff
        LSLS     r3,r3,r4
        BICS     r2,r2,r3
        LSLS     r3,r1,#30
        LSRS     r3,r3,#24
        LSLS     r4,r0,#30
        LSRS     r4,r4,#27
        LSLS     r3,r3,r4
        ORRS     r2,r2,r3
        LDR      r3,|L1.2368|
        LSLS     r4,r0,#28
        LSRS     r4,r4,#28
        SUBS     r4,r4,#8
        LSRS     r4,r4,#2
        LSLS     r4,r4,#2
        STR      r2,[r3,r4]
        B        |L1.2258|
|L1.2208|
        LDR      r2,|L1.2372|
        MOVS     r3,#3
        LSLS     r3,r3,#8
        ADDS     r2,r2,r3
        LSRS     r3,r0,#2
        LSLS     r3,r3,#2
        LDR      r2,[r2,r3]
        LSLS     r3,r0,#30
        LSRS     r4,r3,#27
        MOVS     r3,#0xff
        LSLS     r3,r3,r4
        BICS     r2,r2,r3
        LSLS     r3,r1,#30
        LSRS     r3,r3,#24
        LSLS     r4,r0,#30
        LSRS     r4,r4,#27
        LSLS     r3,r3,r4
        ORRS     r2,r2,r3
        LDR      r3,|L1.2372|
        MOVS     r4,#3
        LSLS     r4,r4,#8
        ADDS     r3,r3,r4
        LSRS     r4,r0,#2
        LSLS     r4,r4,#2
        STR      r2,[r3,r4]
|L1.2258|
        POP      {r4,pc}
        ENDP

GPIO_SET_PIN PROC
        MOVS     r1,#1
        STR      r1,[r0,#0]
        BX       lr
        ENDP

GPIO_CLR_PIN PROC
        MOVS     r1,#0
        STR      r1,[r0,#0]
        BX       lr
        ENDP

I2C_START PROC
        LDR      r1,[r0,#0]
        MOVS     r2,#0x10
        BICS     r1,r1,r2
        MOVS     r2,#0x28
        ORRS     r1,r1,r2
        STR      r1,[r0,#0]
        BX       lr
        ENDP

I2C_STOP PROC
        LDR      r1,[r0,#0]
        MOVS     r2,#0x18
        ORRS     r1,r1,r2
        STR      r1,[r0,#0]
        BX       lr
        ENDP

I2C_DISABLE_I2C PROC
        LDR      r1,[r0,#0]
        MOVS     r2,#0x40
        BICS     r1,r1,r2
        STR      r1,[r0,#0]
        BX       lr
        ENDP

I2C_CLEAR_SI PROC
        LDR      r1,[r0,#0]
        MOVS     r2,#0x30
        BICS     r1,r1,r2
        MOVS     r2,#8
        ORRS     r1,r1,r2
        STR      r1,[r0,#0]
        BX       lr
        ENDP

I2C_SET_AA PROC
        LDR      r1,[r0,#0]
        MOVS     r2,#4
        ORRS     r1,r1,r2
        STR      r1,[r0,#0]
        BX       lr
        ENDP

I2C_CLEAR_AA PROC
        LDR      r1,[r0,#0]
        MOVS     r2,#4
        BICS     r1,r1,r2
        STR      r1,[r0,#0]
        BX       lr
        ENDP

I2C_SET_DATA PROC
        STR      r1,[r0,#8]
        BX       lr
        ENDP

I2C_ENABLE_TOC PROC
        LDR      r1,[r0,#0x14]
        MOVS     r2,#4
        ORRS     r1,r1,r2
        STR      r1,[r0,#0x14]
        BX       lr
        ENDP

I2C_DISABLE_TOC PROC
        LDR      r1,[r0,#0x14]
        MOVS     r2,#4
        BICS     r1,r1,r2
        STR      r1,[r0,#0x14]
        BX       lr
        ENDP

|L1.2364|
        DCD      ack_error
|L1.2368|
        DCD      0xe000ed1c
|L1.2372|
        DCD      0xe000e100

        AREA ||.arm_vfe_header||, DATA, READONLY, NOALLOC, ALIGN=2

        DCD      0x00000000

        AREA ||.data||, DATA, ALIGN=2

ack_error
        DCD      0x00000000
DEVICE_ADDRESS
        DCB      0xae
i2c_current_chip
        DCB      0x00
i2c_state
        DCB      0xa0,0x00
i2c_block_chain_header
        DCD      0x00000000
i2c_block_chain_tail
        DCD      0x00000000
i2c_current_block
        DCD      0x00000000
repeat_time
        DCD      0x00000002
busy_time
        DCD      0x00000000

        EXPORT resumeI2c [CODE]
        EXPORT initI2cDataBlock [CODE]
        EXPORT readI2cChain [CODE]
        EXPORT i2cSpirit [CODE]
        EXPORT addI2cChain [CODE]
        EXPORT I2C0_IRQHandler [CODE]
        EXPORT i2cSysInit [CODE]
        EXPORT readBuf [CODE]
        EXPORT ack_error [DATA,SIZE=4]
        EXPORT i2c_current_chip [DATA,SIZE=1]
        EXPORT i2c_state [DATA,SIZE=1]
        EXPORT i2c_block_chain_header [DATA,SIZE=4]
        EXPORT i2c_block_chain_tail [DATA,SIZE=4]

        IMPORT ||Lib$$Request$$armlib|| [CODE,WEAK]
        IMPORT DrvI2C_Init [CODE]
        IMPORT sysDelayUs [CODE]

        KEEP GPIO_SET_MODE
        KEEP delayus
        KEEP i2cAck
        KEEP ack
        KEEP nack
        KEEP i2cRestart
        KEEP i2cStop
        KEEP i2cWriteByte
        KEEP i2cReadByte
        KEEP i2cStart
        KEEP NVIC_SetPriority
        KEEP GPIO_SET_PIN
        KEEP GPIO_CLR_PIN
        KEEP I2C_START
        KEEP I2C_STOP
        KEEP I2C_DISABLE_I2C
        KEEP I2C_CLEAR_SI
        KEEP I2C_SET_AA
        KEEP I2C_CLEAR_AA
        KEEP I2C_SET_DATA
        KEEP I2C_ENABLE_TOC
        KEEP I2C_DISABLE_TOC
        KEEP DEVICE_ADDRESS
        KEEP i2c_current_block
        KEEP repeat_time
        KEEP busy_time

        ATTR FILESCOPE
        ATTR SETVALUE Tag_ABI_PCS_wchar_t,2
        ATTR SETVALUE Tag_ABI_enum_size,1
        ATTR SETVALUE Tag_ABI_optimization_goals,6
        ATTR SETSTRING Tag_conformance,"2.06"
        ATTR SETVALUE AV,18,1

        ASSERT {ENDIAN} = "little"
        ASSERT {INTER} = {TRUE}
        ASSERT {ROPI} = {FALSE}
        ASSERT {RWPI} = {FALSE}
        ASSERT {IEEE_FULL} = {FALSE}
        ASSERT {IEEE_PART} = {FALSE}
        ASSERT {IEEE_JAVA} = {FALSE}
        END
